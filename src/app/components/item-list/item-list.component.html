<!-- components/codes/item-list/item-list.component.html -->
<div class="p-6">
  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Product Management</h1>
      <p class="text-gray-600">Manage your products, inventory, and pricing</p>
    </div>
    <div class="flex space-x-3">
      <button 
        routerLink="/codes/categories"
        class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2">
        <span>üè∑Ô∏è</span>
        <span>Categories</span>
      </button>
      <button 
      (click)="createProduct()"
        
        class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
        <span>+</span>
        <span>New Product</span>
      </button>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
    <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600">Total Products</p>
          <p class="text-2xl font-bold text-gray-900">{{ items.length }}</p>
        </div>
        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
          <span class="text-blue-600 text-lg">üì¶</span>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600">
            Low Stock</p>
          <p class="text-2xl font-bold text-gray-900">
            {{ lowStockItems }}
        </p>
        </div>
        <div class="w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center">
          <span class="text-orange-600 text-lg">‚ö†Ô∏è</span>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600">Regular Items</p>
          <p class="text-2xl font-bold text-gray-900">
            {{ regularItems}}</p>
        </div>
        <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
          <span class="text-green-600 text-lg">üî•</span>
        </div>
      </div>
    </div>

    <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600">Out of Stock</p>
          <p class="text-2xl font-bold text-gray-900">
            {{outOfStockItems}}</p>
        </div>
        <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center">
          <span class="text-red-600 text-lg">‚ùå</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
    <form [formGroup]="searchForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Search</label>
        <input 
          type="text" 
          formControlName="search"
          placeholder="Search products..."
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
        <select 
          formControlName="category"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          <option value="">All Categories</option>
          <option *ngFor="let category of categories" [value]="category.id">
            {{ category.cateName }}
          </option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Vendor</label>
        <select 
          formControlName="vendor"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          <option value="">All Vendors</option>
          <option *ngFor="let vendor of vendors" [value]="vendor.accId">
            {{ vendor.title }}
          </option>
        </select>
      </div>

      <div class="flex items-end">
        <label class="flex items-center space-x-2">
          <input 
            type="checkbox" 
            formControlName="lowStock"
            class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
          <span class="text-sm text-gray-700">Low Stock Only</span>
        </label>
      </div>
      
      <div class="flex items-end">
        <button 
          type="button"
          (click)="searchForm.reset()"
          class="w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors">
          Clear Filters
        </button>
      </div>
    </form>
  </div>

  <!-- Items Table -->
  <div class="bg-white rounded-xl shadow-sm overflow-hidden">
    <div *ngIf="isLoading" class="p-8 text-center">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
      <p class="text-gray-600 mt-2">Loading products...</p>
    </div>

    <div *ngIf="!isLoading && filteredItems.length === 0" class="p-8 text-center">
      <div class="text-gray-400 text-6xl mb-4">üì¶</div>
      <p class="text-gray-600 text-lg">No products found</p>
      <p class="text-gray-500">Try adjusting your search criteria or create a new product</p>
      <button 
        (click)="createProduct()"
        class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
        Create Your First Product
      </button>
    </div>

    <div *ngIf="!isLoading && filteredItems.length > 0" class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Product Details
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Category & Brand
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Pricing
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Stock
            </th>
            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
              Actions
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let item of filteredItems" class="hover:bg-gray-50 transition-colors">
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                  <span class="text-blue-600 text-sm">üì¶</span>
                </div>
                <div>
                  <div class="text-sm font-medium text-gray-900">{{ item.name }}</div>
                  <div class="text-sm text-gray-500">{{ item.productCode }}</div>
                  <div class="text-xs text-gray-400 truncate max-w-xs">{{ item.description }}</div>
                </div>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900">{{ item.categoryName }}</div>
              <div class="text-sm text-gray-500">{{ item.brandName }}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900">
                Cost: {{ item.costPrice | currency }}
              </div>
              <div class="text-sm font-medium text-green-600">
                Sale: {{ item.salePrice | currency }}
              </div>
              <div class="text-xs text-gray-500">
                Margin: {{ item.salePercent }}%
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center space-x-3">
                <div class="text-sm font-medium text-gray-900">
                  {{ item.stockQty }} {{ getUnitName(item.unitId) }}
                </div>
                <span [class]="'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ' + getStockStatus(item.stockQty).color">
                  {{ getStockStatus(item.stockQty).text }}
                </span>
              </div>
              <button 
                (click)="toggleMostSold(item)"
                [class]="'mt-1 text-xs ' + (item.isMostSoldItem ? 'text-orange-600' : 'text-gray-500')">
                {{ item.isMostSoldItem ? '‚≠ê Most Sold' : '‚òÜ Mark as Most Sold' }}
              </button>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
              <div class="flex justify-end space-x-2">
                <button 
                  [routerLink]="['/codes/items', item.id, 'edit']"
                  class="text-green-600 hover:text-green-900 px-3 py-1 rounded-lg hover:bg-green-50 transition-colors">
                  Edit
                </button>
                <button 
                  (click)="deleteItem(item.id)"
                  class="text-red-600 hover:text-red-900 px-3 py-1 rounded-lg hover:bg-red-50 transition-colors">
                  Delete
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>