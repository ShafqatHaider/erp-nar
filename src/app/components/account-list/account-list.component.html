
<div class="p-6">
  <!-- Header -->
  <div class="flex justify-between items-start mb-6">
    <div>
      <h1 class="text-2xl font-bold text-gray-900">Accounts Management</h1>
      <p class="text-gray-600">Manage your customers, vendors, and other accounts</p>
    </div>
    <button 
      (click)="createAccount()"
      class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2">
      <span>+</span>
      <span>Create Account</span>
    </button>
  </div>

  <!-- Stats Cards -->
  <div *ngIf="!isStatsLoading && stats" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6">
    <!-- Total Accounts -->
    <div class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600">Total Accounts</p>
          <p class="text-2xl font-bold text-gray-900">{{ stats.totalAccounts }}</p>
        </div>
        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
          <span class="text-blue-600 text-lg">üìä</span>
        </div>
      </div>
    </div>

    <!-- Account Types -->
    <div *ngFor="let type of accountTypes" 
         class="bg-white rounded-xl shadow-sm p-4 border border-gray-100">
      <div class="flex items-center justify-between">
        <div>
          <p class="text-sm font-medium text-gray-600">{{ type.label }}</p>
          <p class="text-xl font-bold text-gray-900">{{ getAccountTypeCount(type.value) }}</p>
          <p class="text-xs text-gray-500">
            {{ getAccountTypeStats(type.value)?.totalBalance | currency }}
          </p>
        </div>
        <div [class]="'w-10 h-10 bg-' + type.color + '-100 rounded-lg flex items-center justify-center'">
          <span [class]="'text-' + type.color + '-600 text-lg'">{{ type.icon }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Filters -->
  <div class="bg-white rounded-xl shadow-sm p-4 mb-6">
    <form [formGroup]="searchForm" class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Search</label>
        <input 
          type="text" 
          formControlName="search"
          placeholder="Search by name, type, or category..."
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
      </div>
      
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">Account Type</label>
        <select 
          formControlName="accountType"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
          <option value="">All Types</option>
          <option *ngFor="let type of accountTypes" [value]="type.value">
            {{ type.label }}
          </option>
        </select>
      </div>
      
      <div class="flex items-end">
        <button 
          type="button"
          (click)="searchForm.reset()"
          class="w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors">
          Clear Filters
        </button>
      </div>
    </form>
  </div>

  <!-- Accounts Table -->
  <div class="bg-white rounded-xl shadow-sm overflow-hidden">
    <div *ngIf="isLoading" class="p-8 text-center">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div>
      <p class="text-gray-600 mt-2">Loading accounts...</p>
    </div>

    <div *ngIf="!isLoading && filteredAccounts.length === 0" class="p-8 text-center">
      <div class="text-gray-400 text-6xl mb-4">üìÅ</div>
      <p class="text-gray-600 text-lg">No accounts found</p>
      <p class="text-gray-500">Try adjusting your search criteria or create a new account</p>
      <button 
        (click)="createAccount()"
        class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
        Create Your First Account
      </button>
    </div>

    <div *ngIf="!isLoading && filteredAccounts.length > 0" class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Account Details
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Category & Type
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Opening Balance
            </th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
              Status
            </th>
            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
              Actions
            </th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <tr *ngFor="let account of filteredAccounts" class="hover:bg-gray-50 transition-colors">
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center space-x-3">
                <div [class]="'w-8 h-8 rounded-lg flex items-center justify-center ' + getAccountTypeBadgeColor(account.accountType)">
                  <span class="text-sm">{{ getAccountTypeIcon(account.accountType) }}</span>
                </div>
                <div>
                  <div class="text-sm font-medium text-gray-900">{{ account.title }}</div>
                  <div class="text-sm text-gray-500">ID: {{ account.accId }}</div>
                </div>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex flex-col space-y-1">
                <div class="text-sm text-gray-900">{{ account.accountCategory?.cateAccName }}</div>
                <span [class]="'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ' + getAccountTypeBadgeColor(account.accountType)">
                  {{ account.accountType }}
                </span>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm text-gray-900 font-medium">
                {{ account.openingBalance | currency }}
              </div>
              <div class="text-xs text-gray-500">
                {{ getBalanceTypeText(account.balanceType) }}
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span [class]="account.isActive === 1 ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'" 
                    class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium">
                {{ account.isActive === 1 ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
              <div class="flex justify-end space-x-2">
                <button (click)="viewLedger(account)"

                 class="text-blue-600 hover:text-blue-900 px-3 py-1 rounded-lg hover:bg-blue-50 transition-colors flex items-center space-x-1">
                  <span>üìí</span>
                  <span>Ledger</span>
                </button>
                <button 
                  (click)="onEdit(account)"
                  class="text-green-600 hover:text-green-900 px-3 py-1 rounded-lg hover:bg-green-50 transition-colors flex items-center space-x-1">
                  <span>‚úèÔ∏è</span>
                  <span>Edit</span>
                </button>
                <button 
                  (click)="deleteAccount(account.accId)"
                  class="text-red-600 hover:text-red-900 px-3 py-1 rounded-lg hover:bg-red-50 transition-colors flex items-center space-x-1">
                  <span>üóëÔ∏è</span>
                  <span>Delete</span>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Recent Accounts -->
  <div *ngIf="!isStatsLoading && stats?.recentAccounts?.length" class="mt-8">
    <h3 class="text-lg font-semibold text-gray-900 mb-4">Recently Created Accounts</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <div *ngFor="let account of stats?.recentAccounts" 
           class="bg-white rounded-xl shadow-sm p-4 border border-gray-100 hover:shadow-md transition-shadow">
        <div class="flex items-center space-x-3">
          <div [class]="'w-10 h-10 rounded-lg flex items-center justify-center ' + getAccountTypeBadgeColor(account.accountType)">
            <span class="text-sm">{{ getAccountTypeIcon(account.accountType) }}</span>
          </div>
          <div class="flex-1 min-w-0">
            <p class="text-sm font-medium text-gray-900 truncate">{{ account.title }}</p>
            <p class="text-xs text-gray-500">{{ account.accountType }}</p>
            <p class="text-xs text-gray-500">{{ account.openingBalance | currency }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>